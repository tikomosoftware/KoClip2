# KoClip for .NET

![KoClip Logo](https://img.shields.io/badge/KoClip-v2.0.2-blue.svg)
![.NET](https://img.shields.io/badge/.NET-9.0-purple.svg)
![Platform](https://img.shields.io/badge/platform-Windows-lightgrey.svg)

**KoClip for .NET** は、クリップボードにコピーされた画像を自動的に指定フォルダに保存するWindows用ツールです。オリジナルのDelphi版KoClipをC#/.NETで完全に再実装し、現代的な機能を追加しました。

## ✨ 主な機能

### 🖼️ 自動画像保存
- クリップボードの画像を自動検出・保存
- 重複画像の自動判定（同じ画像の重複保存を防止）
- リアルタイム監視とシステムトレイ常駐

### 📁 柔軟な保存設定
- **保存先選択**: カレントディレクトリ / マイピクチャ / ユーザー指定フォルダ
- **ファイル名設定**: タイムスタンプ形式 / カスタム形式（接頭語・連番・接尾語・桁数指定）
- **保存確認**: 保存前の確認ダイアログ表示（オプション）

### 🎨 多彩な画像形式対応
- **BMP**: 無圧縮形式
- **JPEG**: 品質調整可能（1-100%、デフォルト100%）+ グレースケール変換対応
- **PNG**: 可逆圧縮形式 + グレースケール変換対応
- **Webp**: 最新の高効率形式（品質調整可能、デフォルト100%）+ グレースケール変換対応

### 🔊 サウンド通知
- **ビープ音**: システムビープ
- **デフォルトWAV**: オリジナルのハサミ音
- **無音**: 通知音なし

### ⚙️ 詳細設定
- **自動開始**: アプリ起動時に監視開始
- **監視間隔**: クリップボードチェック間隔調整（100ms-5000ms）
- **アイコンアニメーション**: 監視中のハサミアイコンアニメーション

## 🚀 インストール・使用方法

### システム要件
- **OS**: Windows 10/11 (64bit)
- **.NET**: .NET 9.0 Runtime（自動インストール対応）
- **メモリ**: 最小50MB

### 📥 インストール手順

#### 配布パッケージについて
[Releases](../../releases)では2種類のパッケージを提供しています：

**🔹 .NET同梱版（推奨）**
- **ファイル名**: `KoClip-vX.X.X-standalone-release.zip`
- **.NET Runtimeが含まれています**（約70MB）
- インターネット接続不要で即座に実行可能
- 推奨環境: オフライン環境、企業ネットワーク、確実な動作を求める場合

**🔹 .NET非同梱版（軽量）**
- **ファイル名**: `KoClip-vX.X.X-framework-dependent-release.zip`
- **.NET Runtimeは含まれていません**（約1MB）
- 初回実行時に.NET 9.0 Runtimeが自動ダウンロードされます
- 推奨環境: インターネット接続がある環境、ファイルサイズを抑えたい場合

#### インストール手順
1. [Releases](../../releases)から最新版をダウンロード
   - 環境に応じて同梱版または非同梱版を選択
2. ZIPファイルを任意のフォルダに展開
   - **推奨場所**: `C:\Program Files\KoClip\` または `C:\Tools\KoClip\`
3. `KoClipCS.exe`を実行
   - **同梱版**: そのまま起動します
   - **非同梱版**: 初回実行時に.NET 9.0 Runtimeが必要な場合は自動でダウンロードされます
4. システムトレイにハサミアイコンが表示されれば起動完了

### 🎯 基本的な使い方
1. **監視開始**: システムトレイのハサミアイコンをダブルクリック、または右クリック→「開始」
2. **画像コピー**: 任意のアプリで画像をクリップボードにコピー（Ctrl+C）
3. **自動保存**: 設定したフォルダに自動的に画像が保存されます
4. **設定変更**: システムトレイアイコンを右クリック→「設定」

### 🗑️ アンインストール
- フォルダごと削除してください
- 設定ファイル（`KoClip.json`）も同時に削除されます

## ⚙️ 設定画面詳細

### 全般タブ
- ✅ **ソフト起動時にクリップボードの監視を開始**: 自動開始設定
- ✅ **保存時に確認ダイアログを表示**: 保存前確認
- 📁 **保存先**: カレントディレクトリ / マイピクチャ / ユーザー指定フォルダ
- ⏱️ **クリッピング間隔**: 監視間隔（100-5000ms）

### ファイルタブ
- 📝 **ファイル名生成方法**: 現在時刻 / ユーザー指定
- 🔧 **カスタム設定**: 接頭語・連番・接尾語・桁数の詳細設定
- 👁️ **プレビュー**: 生成されるファイル名のリアルタイム表示

### 形式タブ
- 📷 **ファイル形式**: BMP / JPEG / PNG / Webp
- 🎛️ **品質設定**: JPEG・Webp形式の品質調整（1-100%）
- ⚫ **グレースケール**: JPEG・PNG・Webp形式でのグレースケール変換

### サウンドタブ
- 🔊 **保存時のサウンド**: ビープ音 / デフォルトWAV / 無音

## 🎯 使用例・活用シーン

### 📊 資料作成・プレゼン準備
```
設定例: PNG形式、タイムスタンプ命名、マイピクチャ保存
→ スクリーンショットを次々とコピーして自動整理
```

### 🎨 デザイン・画像収集
```
設定例: Webp形式、カスタム命名（design_001.webp）、専用フォルダ
→ 参考画像を効率的に収集・管理
```

### 📝 ドキュメント作成
```
設定例: JPEG形式（品質80%）、確認ダイアログ有効
→ 必要な画像のみ選択的に保存
```

## 🔧 トラブルシューティング

### よくある問題と解決方法

**❓ 画像が保存されない**
- ✅ 監視が開始されているか確認（システムトレイアイコンがアニメーション中）
- ✅ 保存先フォルダの書き込み権限を確認
- ✅ クリップボードに画像形式のデータがあるか確認

**❓ 設定が保存されない**
- ✅ アプリケーションフォルダの書き込み権限を確認
- ✅ `KoClip.json`ファイルが作成されているか確認
- ✅ ウイルス対策ソフトがファイル作成をブロックしていないか確認

**❓ 同じ画像が何度も保存される**
- ℹ️ 画像比較機能が正常に動作しています。異なる画像として認識される場合があります

**❓ WebP形式で保存できない**
- ✅ .NET 9.0 Runtimeが正しくインストールされているか確認
- ✅ SixLabors.ImageSharp.dllファイルが存在するか確認

**❓ アプリケーションが起動しない**
- ✅ .NET 9.0 Runtimeをマニュアルでインストール
- ✅ Windows Updateを最新に更新
- ✅ 管理者権限で実行を試行

## 📋 技術仕様

### 対応画像形式
| 形式 | 拡張子 | 圧縮 | 品質設定 | グレースケール |
|------|--------|------|----------|----------------|
| BMP  | .bmp   | なし | -        | -              |
| JPEG | .jpg   | 有損 | 1-100%   | ✅             |
| PNG  | .png   | 可逆 | -        | ✅             |
| WebP | .webp  | 有損/可逆 | 1-100% | ✅           |

### 設定ファイル
- **場所**: アプリケーションと同じフォルダ
- **ファイル名**: `KoClip.json`
- **形式**: JSON形式（手動編集可能）

## 🏗️ 開発情報

### 技術スタック
- **言語**: C# 12.0
- **フレームワーク**: .NET 9.0
- **UI**: Windows Forms
- **画像処理**: System.Drawing（BMP/JPEG/PNG） + SixLabors.ImageSharp（WebP専用）
- **設定管理**: System.Text.Json

### ライセンス
このソフトウェアはフリーウェアです。個人・商用問わず自由にご利用いただけます。

**免責事項**: このソフトウェアは「現状のまま」提供され、明示的または暗示的な保証はありません。作者は、このソフトウェアの使用によって生じたいかなる損害についても責任を負いません。

**サードパーティライブラリ**:
- SixLabors.ImageSharp: WebP形式の保存処理に使用（Six Labors Split License）
  - 個人・年間総収入100万USD未満の企業：無料利用可能
  - 年間総収入100万USD以上の企業：商用ライセンス購入が必要
  - 詳細：https://sixlabors.com/pricing/

### 開発者情報
- **オリジナル版**: tikomo（Delphi版）
- **C#移植版**: Developed with Kiro AI
- **バージョン**: 2.0.2 (C# Edition)

## 📞 サポート

- **E-Mail**: tikomo@gmail.com
- **HP**: https://tikomosoftware.github.io

## 📚 更新履歴

### v2.0.2 (C# Edition) - 2026-01-18
**UI・UX改善**
- 🎨 **ヘルプとバージョン情報の統合**: 2つのメニューを1つのタブ付きフォームに統合
  - ヘルプタブ: 使用方法と機能説明
  - バージョン情報タブ: バージョン情報と開発環境の詳細
  - より使いやすいインターフェース
- 📏 **設定画面のレイアウト改善**: ファイルタブのプレビューエリアの見切れを修正
  - フォームの高さを拡大（400px→450px）
  - タブコントロールの高さを拡大（290px→340px）
  - プレビューラベルをTextBoxに変更し、長いファイル名でもスクロール可能に
- 📦 **ビルドプロセスの改善**: リリースZIPファイルをdistフォルダに出力
  - より整理されたプロジェクト構造
  - .gitignoreの更新でクリーンなリポジトリ管理

**テストの強化**
- ✅ **包括的な画像保存テスト**: 全フォーマット（BMP, JPEG, PNG, WebP）での保存機能を検証
- ✅ **グレースケール変換テスト**: 画像のグレースケール変換機能を検証
- ✅ **品質設定テスト**: JPEG・WebPの品質設定機能を検証
- 📊 **テストカバレッジ**: 99テスト全て成功

**技術的改善**
- コードの品質向上
- テストの充実化
- ドキュメントの更新

### v2.0.1 (C# Edition) - 2026-01-13
**UI・安定性の改善**
- 🔧 **設定フォームのレイアウト修正**: OKボタンとキャンセルボタンの見切れ問題を解決
  - フォーム内でのボタン配置を最適化
  - タブコントロールのサイズ調整
  - より使いやすい設定画面を実現
- 📋 **バージョン情報の追加**: アセンブリ情報の充実
  - AssemblyVersion、FileVersion、Versionの明示的設定
  - アプリケーション情報の詳細化
  - より正確なバージョン管理

**技術的改善**
- コードの安定性向上
- ビルドプロセスの改善
- リリースパッケージの品質向上

### v2.0 (C# Edition) - 2026-01-12
- ✨ Delphi版からC#/.NETへの完全移植
- 🆕 WebP形式対応追加（品質調整可能、デフォルト100%）
- 🔧 設定管理の改善（JSON形式、より安定した保存）
- 🎨 UI/UXの現代化（Windows 11対応）
- 🖼️ 画像比較アルゴリズムの改善（重複検出精度向上）
- ⚫ グレースケール変換機能追加（JPEG・PNG・Webp形式対応）
- 🚀 .NET 9.0対応（最新フレームワーク）
- 🔊 オリジナルハサミ音の再現
- 📁 柔軟なファイル名設定（カスタム形式対応）

---

**KoClip for .NET** - シンプルで強力なクリップボード画像自動保存ツール

[![Download](https://img.shields.io/badge/Download-Latest%20Release-brightgreen.svg)](../../releases/latest)

---

© 2026 tikomo software

